<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Go: Syntax | Exisfarの小窝</title><meta name="keywords" content="Go,PL,Polymorphism"><meta name="author" content="Exisfar"><meta name="copyright" content="Exisfar"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Go: Syntax"><meta name="application-name" content="Go: Syntax"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Go: Syntax"><meta property="og:url" content="https://exisfar.github.io/2025/04/20/CS-PL-Go-syntax/index.html"><meta property="og:site_name" content="Exisfarの小窝"><meta property="og:description" content="Go: Syntax Array and Slice 在 Go 语言中，Slice（切片） 和 Array（数组） 是两种不同的数据结构，虽然它们都用于存储相同类型的元素集合，但在使用方式、特性和底层机制上有显著区别。以下是它们的核心区别和适用场景：  1. 定义与声明    特性 Array（数组"><meta property="og:locale" content="en"><meta property="og:image" content="https://exisfar.github.io/img/nightfall.png"><meta property="article:author" content="Exisfar"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://exisfar.github.io/img/nightfall.png"><meta name="description" content="Go: Syntax Array and Slice 在 Go 语言中，Slice（切片） 和 Array（数组） 是两种不同的数据结构，虽然它们都用于存储相同类型的元素集合，但在使用方式、特性和底层机制上有显著区别。以下是它们的核心区别和适用场景：  1. 定义与声明    特性 Array（数组"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://exisfar.github.io/2025/04/20/CS-PL-Go-syntax/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":null},
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: true,
    simplehomepage: false,
    post: true
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"copy":true,"copyrightEbable":true,"limitCount":50,"languages":{"author":"Author: Exisfar","link":"Link: ","source":"Source: Exisfarの小窝","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.","copySuccess":"Copy success, copy and reprint please mark the address of this article"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Exisfarの小窝',
  title: 'Go: Syntax',
  postAI: '',
  pageFillDescription: 'Go Syntax, Array and Slice, 1. 定义与声明, 2. 内存分配与存储, 3. 长度与容量, 4. 使用场景对比, 5. 相互转换, 6. 常见误区, 总结, Interface, 接口的定义, 实现接口的条件, 示例, 解释, 为什么说一种类型实现一种接口类型？, 另一个例子：自定义错误类型, 总结, 实现interface后如何调用实现的方法？, 1. 通过类型变量调用方法, 示例, 输出, 特点, 2. 通过接口类型变量调用方法, 示例, 输出, 特点, 3. 类型断言（Type Assertion）, 示例, 输出, 特点, 总结, Channel, 对于 Go 的 chan如果它是空的读取操作是否会一直阻塞？, net.rpc, 序列化和反序列化在语言中切片和数组是两种不同的数据结构虽然它们都用于存储相同类型的元素集合但在使用方式特性和底层机制上有显著区别以下是它们的核心区别和适用场景定义与声明特性数组切片定义方式固定长度长度是类型的一部分动态长度基于数组的抽象引用类型声明示例或类型签名如如关键区别数组的长度在编译时确定无法修改切片的长度可变底层引用一个数组或数组的片段内存分配与存储特性内存分配值类型直接存储数据引用类型存储指向底层数组的指针长度和容量赋值行为赋值或传参时会复制整个数组赋值或传参时共享底层数组浅拷贝底层结构连续内存块包含三个字段指针示例数组值拷贝复制整个数组输出原数组不变切片共享底层数组共享底层数组输出原切片受影响长度与容量特性长度固定声明时确定动态可变化容量始终等于长度可扩展扩容机制不支持超出容量时自动扩容通常翻倍切片扩容示例容量不足触发扩容容量可能翻倍使用场景对比场景推荐选择原因固定大小的集合数组如月份名称内存紧凑且无扩容开销动态增删元素切片如读取文件内容请求体解析需灵活调整大小函数参数传递切片避免复制整个数组提升性能尤其是大集合需要共享底层数据切片多个切片可引用同一数组修改一处多处可见相互转换数组切片通过切片操作隐式转换切片引用整个数组切片数组需要显式拷贝支持直接转换支持常见误区切片越界访问数组在编译时检查越界切片在运行时检查空切片切片切片底层指针为空切片底层指针非两者和均为但序列化如时行为可能不同总结维度数组切片灵活性低固定长度高动态扩容性能无额外内存开销少量额外开销指针传递成本高值拷贝低引用传递适用场景固定大小只读数据动态集合函数参数简单记忆需要固定大小时用数组如密码哈希像素矩阵其他场景优先用切片的日常代码在语言中一种类型实现一种接口类型的意思是该类型实现了接口中定义的所有方法的接口是隐式实现的这意味着只要一个类型定义了接口中所有的方法它就自动实现了该接口而无需显式声明接口的定义在中接口是一种类型它定义了一组方法签名例如接口定义了一个方法任何类型只要实现了方法就实现了接口实现接口的条件一个类型要实现某个接口必须满足以下条件方法签名一致类型的方法必须与接口中定义的方法签名完全一致方法名参数列表返回值类型实现所有方法类型必须实现接口中定义的所有方法示例以下是一个类型实现接口的例子定义一个接口定义一个类型为类型实现方法创建一个类型的实例将类型的实例赋值给接口变量调用接口方法解释接口定义接口定义了一个方法类型实现接口类型实现了方法因此实现了接口接口变量赋值可以将类型的实例赋值给接口变量因为实现了接口调用接口方法通过接口变量调用方法实际上调用的是类型的方法为什么说一种类型实现一种接口类型隐式实现的接口是隐式实现的不需要显式声明只要类型实现了接口中定义的所有方法就自动实现了该接口多态性通过接口可以实现多态性例如可以将不同的类型赋值给同一个接口变量然后通过接口调用方法而实际执行的是具体类型的方法解耦接口可以将代码解耦调用方法只需要知道接口的定义而不需要关心具体类型另一个例子自定义错误类型在你的代码中类型实现了接口接口实现实现了方法因此它实现了接口使用接口当函数返回时可以将其赋值给接口变量因为实现了接口总结说一种类型实现一种接口类型意味着该类型实现了接口中定义的所有方法的接口是隐式实现的只要类型满足接口的要求就可以将该类型的实例赋值给接口变量从而实现多态性和代码解耦实现后如何调用实现的方法当一个类型实现了一个接口后你可以通过接口类型变量或类型变量来调用实现的方法具体使用哪种方式取决于你的需求和场景以下是详细解释和示例通过类型变量调用方法如果你直接使用类型变量即该类型的实例你可以调用该类型的所有方法包括实现接口的方法和其他不属于接口的方法示例定义一个接口定义一个类型实现接口的方法类型的其他方法创建类型的实例通过类型变量调用方法调用接口方法调用其他方法输出特点可以调用该类型的所有方法包括接口方法和非接口方法直接操作具体类型灵活性更高通过接口类型变量调用方法如果你将类型实例赋值给接口类型变量你只能调用接口中定义的方法这种方式通常用于多态或解耦使得代码不依赖于具体类型示例定义一个接口定义一个类型实现接口的方法创建类型的实例将实例赋值给接口变量通过接口变量调用方法调用接口方法以下代码会报错因为接口变量只能调用接口方法输出特点只能调用接口中定义的方法适合多态场景代码更通用类型断言如果你需要通过接口变量调用具体类型的其他方法可以使用类型断言将接口变量转换回具体类型示例定义一个接口定义一个类型实现接口的方法类型的其他方法创建类型的实例将实例赋值给接口变量通过接口变量调用接口方法使用类型断言将接口变量转换回类型调用类型的其他方法输出特点可以在需要时通过类型断言调用具体类型的其他方法增加了灵活性但需要额外处理类型断言总结方式调用方法范围适用场景类型变量所有方法直接操作具体类型接口变量接口方法多态解耦类型断言具体类型的其他方法需要通过接口调用其他方法时使用类型变量直接操作具体类型调用所有方法使用接口变量实现多态代码更通用但只能调用接口方法使用类型断言在需要时调用具体类型的其他方法根据你的需求选择合适的方式无缓冲通道的问题有缓冲通道的作用对于的如果它是空的读取操作是否会一直阻塞在中从空的读取是否会阻塞取决于的类型和读取方式场景行为无缓冲通道读取会阻塞直到另一个协程写入数据有缓冲通道如果缓冲区为空读取会阻塞直到有数据写入或通道关闭使用非阻塞读取如果为空立即执行分支通道已关闭读取会立即返回零值不会阻塞并通过的判断是否关闭无缓冲通道无缓冲通道写入数据后读取方解除阻塞阻塞直到有数据写入输出行为写入方和读取方必须同时就绪否则会阻塞如果为空且无写入方读取操作会永远阻塞有缓冲通道容量为的有缓冲通道缓冲区为空阻塞行为如果缓冲区有数据读取立即返回数据如果缓冲区为空读取会阻塞直到其他协程写入数据或通道被关闭返回零值非阻塞读取尝试非阻塞读取立即执行行为如果为空跳过分支直接执行避免协程阻塞适合高并发场景已关闭的通道关闭通道输出行为如果通道关闭且无数据读取会立即返回零值等并通过通知调用方不会阻塞即使通道原本是空的如何避免永久阻塞方法超时控制秒超时方法显式关闭通道安全关闭不阻塞返回零值输出方法非阻塞检查写入数据退出循环总结场景读取行为无缓冲空永久阻塞除非有写入方有缓冲空阻塞直到写入或关闭非阻塞立即返回通道已关闭不阻塞返回零值最佳实践如果希望读取方阻塞等待数据用无缓冲有缓冲如果希望非阻塞检查用永远记得在适当的时候关闭通道避免协程泄漏在的系统中注册自定义类型是解决错误的关键步骤以下是详细解释为什么需要注册的默认使用编码来序列化传输数据要求类型一致性发送方和接收方必须知道对方传递的具体类型结构安全限制避免恶意代码通过注入未定义的类型性能优化提前注册类型可以避免运行时反射开销如果不注册自定义类型如无法识别该类型导致序列化失败哪些类型需要注册所有通过传递的自定义结构体例如接口的实现类如果返回接口实际传递的是或则需注册具体实现类如何注册在包初始化时调用注册注册关键点注册位置在包下的共享文件如中注册确保和都导入该包使注册代码执行注册时机必须在第一次调用前完成注册在包加载时自动执行是最佳选择不注册的直接后果错误示例原因尝试通过发送但端解码器不认识该类型实验中的特殊要求禁止修改包外的代码注册必须放在包内如函数字段问题和是函数类型无法序列化函数解决方案从结构体中移除函数字段改为通过参数传递如对比其他序列化方式编码方式是否需要注册类型适用场景是原生默认选择否跨语言调试性能较低是通过高性能跨语言需预编译在中必须使用因为默认依赖它总结问题原因解决方案传递自定义类型失败未注册类型在中调用函数字段无法传递不支持函数改为通过参数或闭包传递最终答案注册自定义类型是为了让的系统能正确识别和序列化你的结构体在中这是解决错误的必需步骤序列化和反序列化序列化和反序列化是计算机科学中两个核心概念用于在不同系统或组件之间安全高效地传输和存储数据以下是通俗易懂的解释序列化定义将程序中的对象或数据结构转换为一种可以存储或传输的格式如二进制流等类比把一辆汽车拆解成零件打包进箱子以便运输用途网络传输如调用数据持久化保存到文件或数据库跨语言通信如服务调用服务中的例子序列化为结果反序列化定义将序列化后的数据重新转换回原始对象或数据结构类比把箱子里的零件重新组装成汽车用途接收网络数据后还原为对象从文件加载数据到内存中的例子现在是一个对象为什么需要序列化跨平台传输内存中的对象是语言特定的但序列化后的格式如可以被任何语言解析保持数据一致性确保发送方和接收方对数据的理解一致例如字段名和类型匹配兼容性允许旧程序读取新版本序列化的数据通过版本控制或默认值常见序列化格式格式特点适用场景文本格式人类可读跨语言配置文件专属二进制格式高效语言内部通信如二进制高性能需预定义微服务高性能通信冗长支持复杂结构旧系统企业级应用中的与序列化在中的默认使用序列化这就是为什么需要提前注册类型告诉长这样以后记得怎么序列化它如果不注册遇到时会报错不认识这个类型注册后能正确将转为二进制并在接收方还原类比现实世界步骤现实类比编程世界序列化把家具拆解打包进纸箱将对象转为二进制传输用卡车运送纸箱通过网络发送数据反序列化拆开纸箱重新组装家具将数据重新转为内存中的对象总结序列化对象可传输存储的格式如反序列化格式对象如在中负责序列化但需提前注册自定义类型通过序列化你的才能从安全到达',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-04-26 12:41:29',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 24
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">Exisfarの小窝</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友链</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> Newest Comments</span></div><div class="aside-list"><span>loading...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Algorithm/" style="font-size: 1.05rem;">Algorithm<sup>3</sup></a><a href="/tags/CS/" style="font-size: 1.05rem;">CS<sup>1</sup></a><a href="/tags/CUDA/" style="font-size: 1.05rem;">CUDA<sup>1</sup></a><a href="/tags/Compiler/" style="font-size: 1.05rem;">Compiler<sup>2</sup></a><a href="/tags/Database/" style="font-size: 1.05rem;">Database<sup>1</sup></a><a href="/tags/Development/" style="font-size: 1.05rem;">Development<sup>5</sup></a><a href="/tags/Dynamic-Programming/" style="font-size: 1.05rem;">Dynamic Programming<sup>1</sup></a><a href="/tags/English/" style="font-size: 1.05rem;">English<sup>1</sup></a><a href="/tags/Graphics/" style="font-size: 1.05rem;">Graphics<sup>2</sup></a><a href="/tags/HPC/" style="font-size: 1.05rem;">HPC<sup>1</sup></a><a href="/tags/Lexical-Analysis/" style="font-size: 1.05rem;">Lexical Analysis<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>2</sup></a><a href="/tags/ML/" style="font-size: 1.05rem;">ML<sup>2</sup></a><a href="/tags/Math/" style="font-size: 1.05rem;">Math<sup>3</sup></a><a href="/tags/Network/" style="font-size: 1.05rem;">Network<sup>1</sup></a><a href="/tags/OS/" style="font-size: 1.05rem;">OS<sup>3</sup></a><a href="/tags/OpenGL/" style="font-size: 1.05rem;">OpenGL<sup>1</sup></a><a href="/tags/Progarmming-Model/" style="font-size: 1.05rem;">Progarmming Model<sup>1</sup></a><a href="/tags/Recursion/" style="font-size: 1.05rem;">Recursion<sup>1</sup></a><a href="/tags/Texture/" style="font-size: 1.05rem;">Texture<sup>1</sup></a><a href="/tags/gcc/" style="font-size: 1.05rem;">gcc<sup>1</sup></a><a href="/tags/normalization/" style="font-size: 1.05rem;">normalization<sup>1</sup></a><a href="/tags/regularization/" style="font-size: 1.05rem;">regularization<sup>1</sup></a><a href="/tags/%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91/" style="font-size: 1.05rem;">业务逻辑<sup>1</sup></a><a href="/tags/%E4%B9%90%E7%90%86/" style="font-size: 1.05rem;">乐理<sup>1</sup></a><a href="/tags/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/" style="font-size: 1.05rem;">体系结构<sup>1</sup></a><a href="/tags/%E5%81%A5%E8%BA%AB/" style="font-size: 1.05rem;">健身<sup>1</sup></a><a href="/tags/%E5%8A%A0%E5%AF%86/" style="font-size: 1.05rem;">加密<sup>7</sup></a><a href="/tags/%E5%90%8C%E6%AD%A5/" style="font-size: 1.05rem;">同步<sup>1</sup></a><a href="/tags/%E5%9B%BE%E8%A1%A8/" style="font-size: 1.05rem;">图表<sup>1</sup></a><a href="/tags/%E5%BC%82%E6%AD%A5/" style="font-size: 1.05rem;">异步<sup>2</sup></a><a href="/tags/%E5%BE%AE%E5%88%86/" style="font-size: 1.05rem;">微分<sup>1</sup></a><a href="/tags/%E6%8A%80%E6%9C%AF%E6%A0%88/" style="font-size: 1.05rem;">技术栈<sup>1</sup></a><a href="/tags/%E6%8A%BD%E8%B1%A1%E8%83%BD%E5%8A%9B/" style="font-size: 1.05rem;">抽象能力<sup>1</sup></a><a href="/tags/%E7%94%9F%E6%B4%BB/" style="font-size: 1.05rem;">生活<sup>3</sup></a><a href="/tags/%E8%A1%A3%E7%89%A9%E5%88%86%E7%B1%BB/" style="font-size: 1.05rem;">衣物分类<sup>1</sup></a><a href="/tags/%E8%A1%A8%E8%BE%BE/" style="font-size: 1.05rem;">表达<sup>1</sup></a><a href="/tags/%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE/" style="font-size: 1.05rem;">逻辑表达<sup>1</sup></a><a href="/tags/%E9%9F%B3%E4%B9%90/" style="font-size: 1.05rem;">音乐<sup>1</sup></a><a href="/tags/%E9%A1%B9%E7%9B%AE%E7%BB%84%E7%BB%87/" style="font-size: 1.05rem;">项目组织<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>Archives</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/04/"><span class="card-archive-list-date">April 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">81</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/03/"><span class="card-archive-list-date">March 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/Go/" itemprop="url">Go</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/Go/PL/" itemprop="url">PL</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Go/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Go</span></a><a class="article-meta__tags" href="/tags/PL/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>PL</span></a><a class="article-meta__tags" href="/tags/Polymorphism/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Polymorphism</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Go: Syntax</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-04-19T17:38:00.000Z" title="Created 2025-04-20 01:38:00">2025-04-20</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-04-26T04:41:29.800Z" title="Updated 2025-04-26 12:41:29">2025-04-26</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为Earth"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>Earth</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="/img/nightfall.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://exisfar.github.io/2025/04/20/CS-PL-Go-syntax/"><header><a class="post-meta-categories" href="/categories/Go/" itemprop="url">Go</a><a class="post-meta-categories" href="/categories/Go/PL/" itemprop="url">PL</a><a href="/tags/Go/" tabindex="-1" itemprop="url">Go</a><a href="/tags/PL/" tabindex="-1" itemprop="url">PL</a><a href="/tags/Polymorphism/" tabindex="-1" itemprop="url">Polymorphism</a><h1 id="CrawlerTitle" itemprop="name headline">Go: Syntax</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Exisfar</span><time itemprop="dateCreated datePublished" datetime="2025-04-19T17:38:00.000Z" title="Created 2025-04-20 01:38:00">2025-04-20</time><time itemprop="dateCreated datePublished" datetime="2025-04-26T04:41:29.800Z" title="Updated 2025-04-26 12:41:29">2025-04-26</time></header><h1>Go: Syntax</h1>
<h2 id="Array-and-Slice">Array and Slice</h2>
<p>在 Go 语言中，Slice（切片） 和 Array（数组） 是两种不同的数据结构，虽然它们都用于存储相同类型的元素集合，但在使用方式、特性和底层机制上有显著区别。以下是它们的核心区别和适用场景：</p>
<hr>
<h3 id="1-定义与声明"><strong>1. 定义与声明</strong></h3>
<table>
<thead>
<tr>
<th>特性</th>
<th>Array（数组）</th>
<th>Slice（切片）</th>
</tr>
</thead>
<tbody>
<tr>
<td>定义方式</td>
<td>固定长度，长度是类型的一部分</td>
<td>动态长度，基于数组的抽象（引用类型）</td>
</tr>
<tr>
<td>声明示例</td>
<td><code>var a [3]int</code></td>
<td><code>var s []int</code> 或 <code>s := make([]int, 3)</code></td>
</tr>
<tr>
<td>类型签名</td>
<td><code>[n]T</code>（如 <code>[3]int</code>）</td>
<td><code>[]T</code>（如 <code>[]int</code>）</td>
</tr>
</tbody>
</table>
<p>关键区别：</p>
<p>• 数组的长度在编译时确定，无法修改。<br>
• 切片的长度可变，底层引用一个数组（或数组的片段）。</p>
<hr>
<h3 id="2-内存分配与存储"><strong>2. 内存分配与存储</strong></h3>
<table>
<thead>
<tr>
<th>特性</th>
<th>Array</th>
<th>Slice</th>
</tr>
</thead>
<tbody>
<tr>
<td>内存分配</td>
<td>值类型，直接存储数据</td>
<td>引用类型，存储指向底层数组的指针、长度和容量</td>
</tr>
<tr>
<td>赋值行为</td>
<td>赋值或传参时会 复制整个数组</td>
<td>赋值或传参时 共享底层数组（浅拷贝）</td>
</tr>
<tr>
<td>底层结构</td>
<td>连续内存块</td>
<td>包含三个字段：<code>ptr</code>（指针）、<code>len</code>、<code>cap</code></td>
</tr>
</tbody>
</table>
<p>示例：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 数组：值拷贝</span></span><br><span class="line">a1 := [<span class="number">3</span>]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">a2 := a1  <span class="comment">// 复制整个数组</span></span><br><span class="line">a2[<span class="number">0</span>] = <span class="number">99</span></span><br><span class="line">fmt.Println(a1[<span class="number">0</span>])  <span class="comment">// 输出 1（原数组不变）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 切片：共享底层数组</span></span><br><span class="line">s1 := []<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">s2 := s1  <span class="comment">// 共享底层数组</span></span><br><span class="line">s2[<span class="number">0</span>] = <span class="number">99</span></span><br><span class="line">fmt.Println(s1[<span class="number">0</span>])  <span class="comment">// 输出 99（原切片受影响）</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="3-长度与容量"><strong>3. 长度与容量</strong></h3>
<table>
<thead>
<tr>
<th>特性</th>
<th>Array</th>
<th>Slice</th>
</tr>
</thead>
<tbody>
<tr>
<td>长度</td>
<td>固定（<code>len(arr)</code> 声明时确定）</td>
<td>动态（<code>len(slice)</code> 可变化）</td>
</tr>
<tr>
<td>容量</td>
<td>始终等于长度</td>
<td>可扩展（<code>cap(slice)</code> ≥ <code>len(slice)</code>）</td>
</tr>
<tr>
<td>扩容机制</td>
<td>不支持</td>
<td>超出容量时自动扩容（通常翻倍）</td>
</tr>
</tbody>
</table>
<p>切片扩容示例：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">s := []<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">fmt.Println(<span class="built_in">len</span>(s), <span class="built_in">cap</span>(s))  <span class="comment">// 3, 3</span></span><br><span class="line">s = <span class="built_in">append</span>(s, <span class="number">4</span>)             <span class="comment">// 容量不足，触发扩容</span></span><br><span class="line">fmt.Println(<span class="built_in">len</span>(s), <span class="built_in">cap</span>(s))  <span class="comment">// 4, 6（容量可能翻倍）</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="4-使用场景对比"><strong>4. 使用场景对比</strong></h3>
<table>
<thead>
<tr>
<th>场景</th>
<th>推荐选择</th>
<th>原因</th>
</tr>
</thead>
<tbody>
<tr>
<td>固定大小的集合</td>
<td>数组</td>
<td>如月份名称（<code>[12]string</code>），内存紧凑且无扩容开销。</td>
</tr>
<tr>
<td>动态增删元素</td>
<td>切片</td>
<td>如读取文件内容、HTTP 请求体解析，需灵活调整大小。</td>
</tr>
<tr>
<td>函数参数传递</td>
<td>切片</td>
<td>避免复制整个数组，提升性能（尤其是大集合）。</td>
</tr>
<tr>
<td>需要共享底层数据</td>
<td>切片</td>
<td>多个切片可引用同一数组，修改一处，多处可见。</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="5-相互转换"><strong>5. 相互转换</strong></h3>
<p>• 数组 → 切片：通过切片操作（隐式转换）</p>
  <figure class="highlight go"><table><tr><td class="code"><pre><span class="line">arr := [<span class="number">3</span>]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">slice := arr[:]  <span class="comment">// 切片引用整个数组</span></span><br></pre></td></tr></table></figure>
<p>• 切片 → 数组：需要显式拷贝（Go 1.17+ 支持直接转换）</p>
  <figure class="highlight go"><table><tr><td class="code"><pre><span class="line">slice := []<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">arr := [<span class="number">3</span>]<span class="type">int</span>(slice)  <span class="comment">// Go 1.17+ 支持</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="6-常见误区"><strong>6. 常见误区</strong></h3>
<ol>
<li>
<p>切片越界访问：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">s := []<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">fmt.Println(s[<span class="number">5</span>])  <span class="comment">// panic: runtime error</span></span><br></pre></td></tr></table></figure>
<p>• 数组在编译时检查越界，切片在运行时检查。</p>
</li>
<li>
<p>空切片 vs <code>nil</code> 切片：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> s1 []<span class="type">int</span>      <span class="comment">// nil 切片（底层指针为 nil）</span></span><br><span class="line">s2 := []<span class="type">int</span>&#123;&#125;      <span class="comment">// 空切片（底层指针非 nil）</span></span><br></pre></td></tr></table></figure>
<p>• 两者 <code>len</code> 和 <code>cap</code> 均为 0，但序列化（如 JSON）时行为可能不同。</p>
</li>
</ol>
<hr>
<h3 id="总结"><strong>总结</strong></h3>
<table>
<thead>
<tr>
<th>维度</th>
<th>Array（数组）</th>
<th>Slice（切片）</th>
</tr>
</thead>
<tbody>
<tr>
<td>灵活性</td>
<td>低（固定长度）</td>
<td>高（动态扩容）</td>
</tr>
<tr>
<td>性能</td>
<td>无额外内存开销</td>
<td>少量额外开销（指针、len、cap）</td>
</tr>
<tr>
<td>传递成本</td>
<td>高（值拷贝）</td>
<td>低（引用传递）</td>
</tr>
<tr>
<td>适用场景</td>
<td>固定大小、只读数据</td>
<td>动态集合、函数参数</td>
</tr>
</tbody>
</table>
<p>简单记忆：<br>
• 需要固定大小时用 数组（如密码哈希、像素矩阵）。<br>
• 其他场景优先用 切片（99% 的日常代码）。</p>
<h2 id="Interface">Interface</h2>
<p>在 Go 语言中，<strong>一种类型实现一种接口类型（interface type）</strong> 的意思是：该类型实现了接口中定义的所有方法。Go 的接口是隐式实现的，这意味着只要一个类型定义了接口中所有的方法，它就自动实现了该接口，而无需显式声明。</p>
<h3 id="接口的定义">接口的定义</h3>
<p>在 Go 中，接口是一种类型，它定义了一组方法签名。例如：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="type">error</span> <span class="keyword">interface</span> &#123;</span><br><span class="line">    Error() <span class="type">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>error</code> 接口定义了一个方法 <code>Error() string</code>。任何类型只要实现了 <code>Error() string</code> 方法，就实现了 <code>error</code> 接口。</p>
<h3 id="实现接口的条件">实现接口的条件</h3>
<p>一个类型要实现某个接口，必须满足以下条件：</p>
<ol>
<li><strong>方法签名一致</strong>：类型的方法必须与接口中定义的方法签名完全一致（方法名、参数列表、返回值类型）。</li>
<li><strong>实现所有方法</strong>：类型必须实现接口中定义的所有方法。</li>
</ol>
<h3 id="示例">示例</h3>
<p>以下是一个类型实现接口的例子：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个接口</span></span><br><span class="line"><span class="keyword">type</span> Speaker <span class="keyword">interface</span> &#123;</span><br><span class="line">	Speak() <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个类型</span></span><br><span class="line"><span class="keyword">type</span> Dog <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 为 Dog 类型实现 Speak 方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d Dog)</span></span> Speak() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;%s says: Woof!&quot;</span>, d.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 创建一个 Dog 类型的实例</span></span><br><span class="line">	d := Dog&#123;Name: <span class="string">&quot;Buddy&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 将 Dog 类型的实例赋值给 Speaker 接口变量</span></span><br><span class="line">	<span class="keyword">var</span> s Speaker = d</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 调用接口方法</span></span><br><span class="line">	fmt.Println(s.Speak())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="解释">解释</h4>
<ol>
<li>
<p><strong>接口定义</strong>：<br>
• <code>Speaker</code> 接口定义了一个方法 <code>Speak() string</code>。</p>
</li>
<li>
<p><strong>类型实现接口</strong>：<br>
• <code>Dog</code> 类型实现了 <code>Speak() string</code> 方法，因此 <code>Dog</code> 实现了 <code>Speaker</code> 接口。</p>
</li>
<li>
<p><strong>接口变量赋值</strong>：<br>
• 可以将 <code>Dog</code> 类型的实例赋值给 <code>Speaker</code> 接口变量 <code>s</code>，因为 <code>Dog</code> 实现了 <code>Speaker</code> 接口。</p>
</li>
<li>
<p><strong>调用接口方法</strong>：<br>
• 通过接口变量 <code>s</code> 调用 <code>Speak()</code> 方法，实际上调用的是 <code>Dog</code> 类型的 <code>Speak()</code> 方法。</p>
</li>
</ol>
<h3 id="为什么说一种类型实现一种接口类型？">为什么说一种类型实现一种接口类型？</h3>
<ol>
<li>
<p><strong>隐式实现</strong>：<br>
• Go 的接口是隐式实现的，不需要显式声明。只要类型实现了接口中定义的所有方法，就自动实现了该接口。</p>
</li>
<li>
<p><strong>多态性</strong>：<br>
• 通过接口，可以实现多态性。例如，可以将不同的类型赋值给同一个接口变量，然后通过接口调用方法，而实际执行的是具体类型的方法。</p>
</li>
<li>
<p><strong>解耦</strong>：<br>
• 接口可以将代码解耦。调用方法只需要知道接口的定义，而不需要关心具体类型。</p>
</li>
</ol>
<h3 id="另一个例子：自定义错误类型">另一个例子：自定义错误类型</h3>
<p>在你的代码中，<code>ErrNegativeSqrt</code> 类型实现了 <code>error</code> 接口：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> ErrNegativeSqrt <span class="type">float64</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(e ErrNegativeSqrt)</span></span> Error() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;cannot Sqrt negative number: %v&quot;</span>, <span class="type">float64</span>(e))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>
<p><strong>接口实现</strong>：<br>
• <code>ErrNegativeSqrt</code> 实现了 <code>Error() string</code> 方法，因此它实现了 <code>error</code> 接口。</p>
</li>
<li>
<p><strong>使用接口</strong>：<br>
• 当 <code>Sqrt</code> 函数返回 <code>ErrNegativeSqrt</code> 时，可以将其赋值给 <code>error</code> 接口变量，因为 <code>ErrNegativeSqrt</code> 实现了 <code>error</code> 接口。</p>
</li>
</ol>
<h3 id="总结-2">总结</h3>
<p>说一种类型实现一种接口类型，意味着该类型实现了接口中定义的所有方法。Go 的接口是隐式实现的，只要类型满足接口的要求，就可以将该类型的实例赋值给接口变量，从而实现多态性和代码解耦。</p>
<h2 id="实现interface后如何调用实现的方法？">实现interface后如何调用实现的方法？</h2>
<p>当一个类型实现了一个接口后，你可以通过 <strong>接口类型变量</strong> 或 <strong>类型变量</strong> 来调用实现的方法。具体使用哪种方式取决于你的需求和场景。以下是详细解释和示例：</p>
<hr>
<h3 id="1-通过类型变量调用方法">1. <strong>通过类型变量调用方法</strong></h3>
<p>如果你直接使用类型变量（即该类型的实例），你可以调用该类型的所有方法，包括实现接口的方法和其他不属于接口的方法。</p>
<h4 id="示例-2">示例</h4>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个接口</span></span><br><span class="line"><span class="keyword">type</span> Speaker <span class="keyword">interface</span> &#123;</span><br><span class="line">	Speak() <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个类型</span></span><br><span class="line"><span class="keyword">type</span> Dog <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现 Speaker 接口的方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d Dog)</span></span> Speak() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;%s says: Woof!&quot;</span>, d.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Dog 类型的其他方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d Dog)</span></span> Fetch() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;%s is fetching a ball!&quot;</span>, d.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 创建 Dog 类型的实例</span></span><br><span class="line">	d := Dog&#123;Name: <span class="string">&quot;Buddy&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 通过类型变量调用方法</span></span><br><span class="line">	fmt.Println(d.Speak())  <span class="comment">// 调用接口方法</span></span><br><span class="line">	fmt.Println(d.Fetch())  <span class="comment">// 调用其他方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="输出">输出</h4>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Buddy says: Woof!</span><br><span class="line">Buddy is fetching a ball!</span><br></pre></td></tr></table></figure>
<h4 id="特点">特点</h4>
<p>• 可以调用该类型的所有方法（包括接口方法和非接口方法）。<br>
• 直接操作具体类型，灵活性更高。</p>
<hr>
<h3 id="2-通过接口类型变量调用方法">2. <strong>通过接口类型变量调用方法</strong></h3>
<p>如果你将类型实例赋值给接口类型变量，你只能调用接口中定义的方法。这种方式通常用于 <strong>多态</strong> 或 <strong>解耦</strong>，使得代码不依赖于具体类型。</p>
<h4 id="示例-3">示例</h4>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个接口</span></span><br><span class="line"><span class="keyword">type</span> Speaker <span class="keyword">interface</span> &#123;</span><br><span class="line">	Speak() <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个类型</span></span><br><span class="line"><span class="keyword">type</span> Dog <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现 Speaker 接口的方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d Dog)</span></span> Speak() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;%s says: Woof!&quot;</span>, d.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 创建 Dog 类型的实例</span></span><br><span class="line">	d := Dog&#123;Name: <span class="string">&quot;Buddy&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 将 Dog 实例赋值给 Speaker 接口变量</span></span><br><span class="line">	<span class="keyword">var</span> s Speaker = d</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 通过接口变量调用方法</span></span><br><span class="line">	fmt.Println(s.Speak())  <span class="comment">// 调用接口方法</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 以下代码会报错，因为接口变量只能调用接口方法</span></span><br><span class="line">	<span class="comment">// fmt.Println(s.Fetch())</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="输出-2">输出</h4>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Buddy says: Woof!</span><br></pre></td></tr></table></figure>
<h4 id="特点-2">特点</h4>
<p>• 只能调用接口中定义的方法。<br>
• 适合多态场景，代码更通用。</p>
<hr>
<h3 id="3-类型断言（Type-Assertion）">3. <strong>类型断言（Type Assertion）</strong></h3>
<p>如果你需要通过接口变量调用具体类型的其他方法，可以使用 <strong>类型断言</strong> 将接口变量转换回具体类型。</p>
<h4 id="示例-4">示例</h4>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个接口</span></span><br><span class="line"><span class="keyword">type</span> Speaker <span class="keyword">interface</span> &#123;</span><br><span class="line">	Speak() <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个类型</span></span><br><span class="line"><span class="keyword">type</span> Dog <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现 Speaker 接口的方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d Dog)</span></span> Speak() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;%s says: Woof!&quot;</span>, d.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Dog 类型的其他方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d Dog)</span></span> Fetch() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;%s is fetching a ball!&quot;</span>, d.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 创建 Dog 类型的实例</span></span><br><span class="line">	d := Dog&#123;Name: <span class="string">&quot;Buddy&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 将 Dog 实例赋值给 Speaker 接口变量</span></span><br><span class="line">	<span class="keyword">var</span> s Speaker = d</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 通过接口变量调用接口方法</span></span><br><span class="line">	fmt.Println(s.Speak())</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 使用类型断言将接口变量转换回 Dog 类型</span></span><br><span class="line">	<span class="keyword">if</span> dog, ok := s.(Dog); ok &#123;</span><br><span class="line">		fmt.Println(dog.Fetch())  <span class="comment">// 调用 Dog 类型的其他方法</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="输出-3">输出</h4>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Buddy says: Woof!</span><br><span class="line">Buddy is fetching a ball!</span><br></pre></td></tr></table></figure>
<h4 id="特点-3">特点</h4>
<p>• 可以在需要时通过类型断言调用具体类型的其他方法。<br>
• 增加了灵活性，但需要额外处理类型断言。</p>
<hr>
<h3 id="总结-3">总结</h3>
<table>
<thead>
<tr>
<th>方式</th>
<th>调用方法范围</th>
<th>适用场景</th>
</tr>
</thead>
<tbody>
<tr>
<td>类型变量</td>
<td>所有方法</td>
<td>直接操作具体类型</td>
</tr>
<tr>
<td>接口变量</td>
<td>接口方法</td>
<td>多态、解耦</td>
</tr>
<tr>
<td>类型断言</td>
<td>具体类型的其他方法</td>
<td>需要通过接口调用其他方法时</td>
</tr>
</tbody>
</table>
<p>• <strong>使用类型变量</strong>：直接操作具体类型，调用所有方法。<br>
• <strong>使用接口变量</strong>：实现多态，代码更通用，但只能调用接口方法。<br>
• <strong>使用类型断言</strong>：在需要时调用具体类型的其他方法。</p>
<p>根据你的需求选择合适的方式！</p>
<h2 id="Channel">Channel</h2>
<p>无缓冲通道 (make(chan Task)) 的问题​</p>
<p>有缓冲通道 (make(chan Task, len(files) + nReduce)) 的作用​</p>
<h3 id="对于-Go-的-chan，如果它是空的，读取操作是否会一直阻塞？"><strong>对于 Go 的 <code>chan</code>，如果它是空的，读取操作是否会一直阻塞？</strong></h3>
<p>在 Go 中，从空的 <code>chan</code> 读取是否会阻塞，取决于 <code>chan</code> 的类型和读取方式：</p>
<table>
<thead>
<tr>
<th>场景</th>
<th>行为</th>
</tr>
</thead>
<tbody>
<tr>
<td>无缓冲通道（<code>make(chan T)</code>）</td>
<td>读取会阻塞，直到另一个协程写入数据。</td>
</tr>
<tr>
<td>有缓冲通道（<code>make(chan T, N)</code>）</td>
<td>如果缓冲区为空，读取会阻塞，直到有数据写入或通道关闭。</td>
</tr>
<tr>
<td>使用 <code>select</code> + <code>default</code></td>
<td>非阻塞读取，如果 <code>chan</code> 为空，立即执行 <code>default</code> 分支。</td>
</tr>
<tr>
<td>通道已关闭</td>
<td>读取会立即返回零值（不会阻塞），并通过 <code>val, ok := &lt;-ch</code> 的 <code>ok</code> 判断是否关闭。</td>
</tr>
</tbody>
</table>
<hr>
<p><strong>1. 无缓冲通道（Unbuffered Channel）</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>)  <span class="comment">// 无缓冲通道</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    time.Sleep(<span class="number">1</span> * time.Second)</span><br><span class="line">    ch &lt;- <span class="number">42</span>  <span class="comment">// 写入数据后，读取方解除阻塞</span></span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line">val := &lt;-ch  <span class="comment">// 阻塞，直到有数据写入</span></span><br><span class="line">fmt.Println(val) <span class="comment">// 输出 42</span></span><br></pre></td></tr></table></figure>
<p>行为：<br>
• 写入方（<code>ch &lt;- data</code>）和读取方（<code>&lt;-ch</code>）必须同时就绪，否则会阻塞。</p>
<p>• 如果 <code>ch</code> 为空且无写入方，读取操作会永远阻塞。</p>
<hr>
<p><strong>2. 有缓冲通道（Buffered Channel）</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">1</span>)  <span class="comment">// 容量为1的有缓冲通道</span></span><br><span class="line"></span><br><span class="line">val := &lt;-ch  <span class="comment">// 缓冲区为空，阻塞！</span></span><br><span class="line">fmt.Println(val)</span><br></pre></td></tr></table></figure>
<p>行为：<br>
• 如果缓冲区有数据，读取立即返回数据。</p>
<p>• 如果缓冲区为空，读取会阻塞，直到：</p>
<p>• 其他协程写入数据，或</p>
<p>• 通道被关闭（返回零值）。</p>
<hr>
<p><strong>3. 非阻塞读取（<code>select</code> + <code>default</code>）</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> val := &lt;-ch:  <span class="comment">// 尝试非阻塞读取</span></span><br><span class="line">    fmt.Println(<span class="string">&quot;Got:&quot;</span>, val)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    fmt.Println(<span class="string">&quot;Channel is empty!&quot;</span>)  <span class="comment">// 立即执行</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>行为：<br>
• 如果 <code>ch</code> 为空，跳过 <code>case</code> 分支，直接执行 <code>default</code>。</p>
<p>• 避免协程阻塞，适合高并发场景。</p>
<hr>
<p><strong>4. 已关闭的通道</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>)</span><br><span class="line"><span class="built_in">close</span>(ch)  <span class="comment">// 关闭通道</span></span><br><span class="line"></span><br><span class="line">val, ok := &lt;-ch</span><br><span class="line">fmt.Println(val, ok)  <span class="comment">// 输出 0 false</span></span><br></pre></td></tr></table></figure>
<p>行为：<br>
• 如果通道关闭且无数据，读取会立即返回零值（<code>0</code>、<code>nil</code> 等），并通过 <code>ok=false</code> 通知调用方。</p>
<p>• 不会阻塞，即使通道原本是空的。</p>
<hr>
<p><strong>5. 如何避免永久阻塞？</strong></p>
<p><strong>方法 1：超时控制</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>)</span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> val := &lt;-ch:</span><br><span class="line">    fmt.Println(val)</span><br><span class="line"><span class="keyword">case</span> &lt;-time.After(<span class="number">1</span> * time.Second):  <span class="comment">// 1秒超时</span></span><br><span class="line">    fmt.Println(<span class="string">&quot;Timeout!&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>方法 2：显式关闭通道</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>)</span><br><span class="line"><span class="built_in">close</span>(ch)  <span class="comment">// 安全关闭</span></span><br><span class="line"></span><br><span class="line">val := &lt;-ch  <span class="comment">// 不阻塞，返回零值</span></span><br><span class="line">fmt.Println(val) <span class="comment">// 输出 0</span></span><br></pre></td></tr></table></figure>
<p><strong>方法 3：非阻塞检查</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">1</span>)</span><br><span class="line">ch &lt;- <span class="number">42</span>  <span class="comment">// 写入数据</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> val := &lt;-ch:</span><br><span class="line">        fmt.Println(<span class="string">&quot;Got:&quot;</span>, val)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">return</span>  <span class="comment">// 退出循环</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>总结</strong></p>
<table>
<thead>
<tr>
<th>场景</th>
<th>读取行为</th>
</tr>
</thead>
<tbody>
<tr>
<td>无缓冲空 <code>chan</code></td>
<td>永久阻塞（除非有写入方）</td>
</tr>
<tr>
<td>有缓冲空 <code>chan</code></td>
<td>阻塞，直到写入或关闭</td>
</tr>
<tr>
<td><code>select</code> + <code>default</code></td>
<td>非阻塞，立即返回</td>
</tr>
<tr>
<td>通道已关闭</td>
<td>不阻塞，返回零值</td>
</tr>
</tbody>
</table>
<p>最佳实践：<br>
• 如果希望读取方阻塞等待数据，用无缓冲/有缓冲 <code>chan</code>。</p>
<p>• 如果希望非阻塞检查，用 <code>select</code> + <code>default</code>。</p>
<p>• 永远记得在适当的时候 关闭通道，避免协程泄漏！</p>
<h2 id="net-rpc">net.rpc</h2>
<p>在 Go 的 RPC 系统中，注册自定义类型是解决 <code>gob: type not registered for interface</code> 错误的关键步骤。以下是详细解释：</p>
<hr>
<p><strong>1. 为什么需要注册？</strong><br>
Go 的 <code>net/rpc</code> 默认使用 <code>gob</code> 编码来序列化（传输）数据。<code>gob</code> 要求：<br>
• 类型一致性：发送方和接收方必须知道对方传递的具体类型结构。</p>
<p>• 安全限制：避免恶意代码通过 RPC 注入未定义的类型。</p>
<p>• 性能优化：提前注册类型可以避免运行时反射开销。</p>
<p>如果不注册自定义类型（如 <code>MapTask</code>），<code>gob</code> 无法识别该类型，导致序列化失败。</p>
<hr>
<p><strong>2. 哪些类型需要注册？</strong><br>
• 所有通过 RPC 传递的自定义结构体：</p>
<p>• 例如 <code>MapTask</code>、<code>ReduceTask</code>。</p>
<p>• 接口的实现类：</p>
<p>• 如果 RPC 返回 <code>Task</code> 接口，实际传递的是 <code>*MapTask</code> 或 <code>*ReduceTask</code>，则需注册具体实现类。</p>
<hr>
<p><strong>3. 如何注册？</strong><br>
在 包初始化时（<code>init()</code>）调用 <code>gob.Register()</code>：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> mr</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;encoding/gob&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">    gob.Register(&amp;MapTask&#123;&#125;)    <span class="comment">// 注册 MapTask</span></span><br><span class="line">    gob.Register(&amp;ReduceTask&#123;&#125;) <span class="comment">// 注册 ReduceTask</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>关键点</strong>：</p>
<ol>
<li>
<p>注册位置：<br>
• 在 <code>mr</code> 包下的共享文件（如 <code>rpc.go</code>）中注册。</p>
<p>• 确保 Coordinator 和 Worker 都导入该包，使注册代码执行。</p>
</li>
<li>
<p>注册时机：<br>
• 必须在 第一次 RPC 调用前 完成注册（<code>init()</code> 在包加载时自动执行，是最佳选择）。</p>
</li>
</ol>
<hr>
<p><strong>4. 不注册的直接后果</strong><br>
• 错误示例：</p>
  <figure class="highlight go"><table><tr><td class="code"><pre><span class="line">gob: <span class="keyword">type</span> not registered <span class="keyword">for</span> <span class="keyword">interface</span>: mr.MapTask</span><br></pre></td></tr></table></figure>
<p>• 原因：</p>
<p>• Coordinator 尝试通过 RPC 发送 <code>*MapTask</code>，但 Worker 端 <code>gob</code> 解码器不认识该类型。</p>
<hr>
<p><strong>5. 实验中的特殊要求（6.5840 Lab 1）</strong><br>
• 禁止修改 <code>mr</code> 包外的代码：注册必须放在 <code>mr</code> 包内（如 <code>rpc.go</code>）。</p>
<p>• 函数字段问题：</p>
<p>• <code>MapTask.Mapf</code> 和 <code>ReduceTask.Reducef</code> 是函数类型，<code>gob</code> 无法序列化函数。</p>
<p>• 解决方案：从结构体中移除函数字段，改为通过 Worker 参数传递（如 <code>Worker(mapf, reducef)</code>）。</p>
<hr>
<p><strong>6. 对比其他序列化方式</strong></p>
<table>
<thead>
<tr>
<th>编码方式</th>
<th>是否需要注册类型？</th>
<th>适用场景</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gob</code></td>
<td>是</td>
<td>Go 原生 RPC（默认选择）</td>
</tr>
<tr>
<td><code>JSON</code></td>
<td>否</td>
<td>跨语言、调试（性能较低）</td>
</tr>
<tr>
<td><code>Protobuf</code></td>
<td>是（通过 <code>.proto</code>）</td>
<td>高性能、跨语言（需预编译）</td>
</tr>
</tbody>
</table>
<p>在 6.5840 Lab 1 中，必须使用 <code>gob</code>（因为 <code>net/rpc</code> 默认依赖它）。</p>
<hr>
<p><strong>7. 总结</strong></p>
<table>
<thead>
<tr>
<th>问题</th>
<th>原因</th>
<th>解决方案</th>
</tr>
</thead>
<tbody>
<tr>
<td>RPC 传递自定义类型失败</td>
<td><code>gob</code> 未注册类型</td>
<td>在 <code>init()</code> 中调用 <code>gob.Register()</code></td>
</tr>
<tr>
<td>函数字段无法传递</td>
<td><code>gob</code> 不支持函数</td>
<td>改为通过参数或闭包传递</td>
</tr>
</tbody>
</table>
<p>最终答案：<br>
注册自定义类型是为了让 Go 的 RPC 系统能正确识别和序列化你的结构体。在 6.5840 Lab 1 中，这是解决 <code>gob: type not registered</code> 错误的必需步骤。</p>
<h2 id="序列化和反序列化">序列化和反序列化</h2>
<p>序列化（Serialization）和反序列化（Deserialization）是计算机科学中两个核心概念，用于在不同系统或组件之间安全、高效地传输和存储数据。以下是通俗易懂的解释：</p>
<hr>
<p><strong>1. 序列化（Serialization）</strong><br>
• 定义：将程序中的对象或数据结构转换为一种可以存储或传输的格式（如二进制流、JSON、XML等）。</p>
<p>• 类比：把一辆汽车拆解成零件，打包进箱子以便运输。</p>
<p>• 用途：</p>
<p>• 网络传输（如 RPC 调用）</p>
<p>• 数据持久化（保存到文件或数据库）</p>
<p>• 跨语言通信（如 Go 服务调用 Python 服务）</p>
<p><strong>Go 中的例子</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="type">string</span></span><br><span class="line">    Age  <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 序列化为 JSON</span></span><br><span class="line">p := Person&#123;<span class="string">&quot;Alice&quot;</span>, <span class="number">25</span>&#125;</span><br><span class="line">bytes, _ := json.Marshal(p)</span><br><span class="line"><span class="comment">// 结果：`&#123;&quot;Name&quot;:&quot;Alice&quot;,&quot;Age&quot;:25&#125;`</span></span><br></pre></td></tr></table></figure>
<hr>
<p><strong>2. 反序列化（Deserialization）</strong><br>
• 定义：将序列化后的数据重新转换回原始对象或数据结构。</p>
<p>• 类比：把箱子里的零件重新组装成汽车。</p>
<p>• 用途：</p>
<p>• 接收网络数据后还原为对象</p>
<p>• 从文件加载数据到内存</p>
<p><strong>Go 中的例子</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p Person</span><br><span class="line">jsonStr := <span class="string">`&#123;&quot;Name&quot;:&quot;Alice&quot;,&quot;Age&quot;:25&#125;`</span></span><br><span class="line">json.Unmarshal([]<span class="type">byte</span>(jsonStr), &amp;p)</span><br><span class="line"><span class="comment">// p 现在是一个 Person 对象：&#123;Alice 25&#125;</span></span><br></pre></td></tr></table></figure>
<hr>
<p><strong>3. 为什么需要序列化？</strong></p>
<ol>
<li>
<p>跨平台传输<br>
内存中的对象是语言特定的，但序列化后的格式（如 JSON）可以被任何语言解析。</p>
</li>
<li>
<p>保持数据一致性<br>
确保发送方和接收方对数据的理解一致（例如，字段名和类型匹配）。</p>
</li>
<li>
<p>兼容性<br>
允许旧程序读取新版本序列化的数据（通过版本控制或默认值）。</p>
</li>
</ol>
<hr>
<p><strong>4. 常见序列化格式</strong></p>
<table>
<thead>
<tr>
<th>格式</th>
<th>特点</th>
<th>适用场景</th>
</tr>
</thead>
<tbody>
<tr>
<td>JSON</td>
<td>文本格式，人类可读，跨语言</td>
<td>Web API、配置文件</td>
</tr>
<tr>
<td>Gob</td>
<td>Go 专属二进制格式，高效</td>
<td>Go 语言内部通信（如 RPC）</td>
</tr>
<tr>
<td>Protobuf</td>
<td>二进制，高性能，需预定义 schema</td>
<td>微服务、高性能通信</td>
</tr>
<tr>
<td>XML</td>
<td>冗长，支持复杂结构</td>
<td>旧系统、企业级应用</td>
</tr>
</tbody>
</table>
<hr>
<p><strong>5. Go 中的 RPC 与序列化</strong><br>
在 6.5840 Lab 1 中，Go 的 <code>net/rpc</code> 默认使用 <code>gob</code> 序列化。这就是为什么需要提前注册类型：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">gob.Register(&amp;MapTask&#123;&#125;) <span class="comment">// 告诉 gob：&quot;MapTask 长这样，以后记得怎么序列化它&quot;</span></span><br></pre></td></tr></table></figure>
<p>• 如果不注册：<code>gob</code> 遇到 <code>MapTask</code> 时会报错（不认识这个类型）。</p>
<p>• 注册后：<code>gob</code> 能正确将 <code>MapTask</code> 转为二进制，并在接收方还原。</p>
<hr>
<p><strong>6. 类比现实世界</strong></p>
<table>
<thead>
<tr>
<th>步骤</th>
<th>现实类比</th>
<th>编程世界</th>
</tr>
</thead>
<tbody>
<tr>
<td>序列化</td>
<td>把家具拆解打包进纸箱</td>
<td>将对象转为 JSON/二进制</td>
</tr>
<tr>
<td>传输</td>
<td>用卡车运送纸箱</td>
<td>通过网络发送数据</td>
</tr>
<tr>
<td>反序列化</td>
<td>拆开纸箱重新组装家具</td>
<td>将数据重新转为内存中的对象</td>
</tr>
</tbody>
</table>
<hr>
<p><strong>7. 总结</strong><br>
• 序列化：对象 → 可传输/存储的格式（如 <code>struct</code> → <code>[]byte</code>）。</p>
<p>• 反序列化：格式 → 对象（如 <code>[]byte</code> → <code>struct</code>）。</p>
<p>• 在 Go RPC 中：<code>gob</code> 负责序列化，但需提前注册自定义类型。</p>
<p>通过序列化，你的 <code>MapTask</code> 才能从 Coordinator 安全到达 Worker！</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/nightfall.png&quot;" data-lazy-src="/img/avatar.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/nightfall.png&quot;" data-lazy-src="/img/avatar.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">Exisfar</div><div class="post-copyright__author_desc">这是我的小窝，欢迎光临！</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://exisfar.github.io/2025/04/20/CS-PL-Go-syntax/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://exisfar.github.io/2025/04/20/CS-PL-Go-syntax/')">Go: Syntax</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://exisfar.github.io/2025/04/20/CS-PL-Go-syntax/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=Go: Syntax&amp;url=https://exisfar.github.io/2025/04/20/CS-PL-Go-syntax/&amp;pic=/img/nightfall.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Go/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Go<span class="tagsPageCount">5</span></a><a class="post-meta__box__tags" href="/tags/PL/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>PL<span class="tagsPageCount">6</span></a><a class="post-meta__box__tags" href="/tags/Polymorphism/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Polymorphism<span class="tagsPageCount">2</span></a></div></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/04/20/CS-PL-Go-%E9%A1%B9%E7%9B%AE%E7%BB%84%E7%BB%87/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/nightfall.png&quot;" data-lazy-src="/img/nightfall.png" onerror="onerror=null;src='/img/nightfall.png'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Go: 项目组织</div></div></a></div><div class="next-post pull-right"><a href="/2025/04/20/CS-PL-Go-framework/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/nightfall.png&quot;" data-lazy-src="/img/nightfall.png" onerror="onerror=null;src='/img/nightfall.png'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Go: Frameworks</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2025/04/20/CS-PL-Go-core-ideas/" title="Go: Core Ideas"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/nightfall.png&quot;" data-lazy-src="/img/nightfall.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-04-20</div><div class="title">Go: Core Ideas</div></div></a></div><div><a href="/2025/04/20/CS-PL-Go-framework/" title="Go: Frameworks"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/nightfall.png&quot;" data-lazy-src="/img/nightfall.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-04-20</div><div class="title">Go: Frameworks</div></div></a></div><div><a href="/2025/04/20/CS-PL-Go-%E9%A1%B9%E7%9B%AE%E7%BB%84%E7%BB%87/" title="Go: 项目组织"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/nightfall.png&quot;" data-lazy-src="/img/nightfall.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-04-20</div><div class="title">Go: 项目组织</div></div></a></div><div><a href="/2025/04/29/CS-PL-JS-asynchronous-programming/" title="Javascript: Asynchronous Programming"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/nightfall.png&quot;" data-lazy-src="/img/nightfall.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-04-29</div><div class="title">Javascript: Asynchronous Programming</div></div></a></div><div><a href="/2025/04/20/CS-PL-Python-object-reference/" title="Python: pass by object reference"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/nightfall.png&quot;" data-lazy-src="/img/nightfall.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-04-20</div><div class="title">Python: pass by object reference</div></div></a></div><div><a href="/2025/04/20/CS-PL-Python-package/" title="Python中的Package"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/nightfall.png&quot;" data-lazy-src="/img/nightfall.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-04-20</div><div class="title">Python中的Package</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> Comment</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/nightfall.png&quot;" data-lazy-src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/nightfall.png&quot;" data-lazy-src="https://emotion.acs.pw/emotion/HONKAI3/16.gif" alt="status"/></div></div><div class="author-info__description">Full Stack Developer</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">Exisfar</h1><div class="author-info__desc">这是我的小窝，欢迎光临！</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/Exisfar" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="/cunyuanwu@qq.com" target="_blank" title="Email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">Go: Syntax</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Array-and-Slice"><span class="toc-number">1.1.</span> <span class="toc-text">Array and Slice</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%9A%E4%B9%89%E4%B8%8E%E5%A3%B0%E6%98%8E"><span class="toc-number">1.1.1.</span> <span class="toc-text">1. 定义与声明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E4%B8%8E%E5%AD%98%E5%82%A8"><span class="toc-number">1.1.2.</span> <span class="toc-text">2. 内存分配与存储</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%95%BF%E5%BA%A6%E4%B8%8E%E5%AE%B9%E9%87%8F"><span class="toc-number">1.1.3.</span> <span class="toc-text">3. 长度与容量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%E5%AF%B9%E6%AF%94"><span class="toc-number">1.1.4.</span> <span class="toc-text">4. 使用场景对比</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.1.5.</span> <span class="toc-text">5. 相互转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%B8%B8%E8%A7%81%E8%AF%AF%E5%8C%BA"><span class="toc-number">1.1.6.</span> <span class="toc-text">6. 常见误区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.1.7.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Interface"><span class="toc-number">1.2.</span> <span class="toc-text">Interface</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">1.2.1.</span> <span class="toc-text">接口的定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E6%8E%A5%E5%8F%A3%E7%9A%84%E6%9D%A1%E4%BB%B6"><span class="toc-number">1.2.2.</span> <span class="toc-text">实现接口的条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.2.3.</span> <span class="toc-text">示例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%87%8A"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">解释</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AF%B4%E4%B8%80%E7%A7%8D%E7%B1%BB%E5%9E%8B%E5%AE%9E%E7%8E%B0%E4%B8%80%E7%A7%8D%E6%8E%A5%E5%8F%A3%E7%B1%BB%E5%9E%8B%EF%BC%9F"><span class="toc-number">1.2.4.</span> <span class="toc-text">为什么说一种类型实现一种接口类型？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%A6%E4%B8%80%E4%B8%AA%E4%BE%8B%E5%AD%90%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E9%94%99%E8%AF%AF%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.5.</span> <span class="toc-text">另一个例子：自定义错误类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-2"><span class="toc-number">1.2.6.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0interface%E5%90%8E%E5%A6%82%E4%BD%95%E8%B0%83%E7%94%A8%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%9F"><span class="toc-number">1.3.</span> <span class="toc-text">实现interface后如何调用实现的方法？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%80%9A%E8%BF%87%E7%B1%BB%E5%9E%8B%E5%8F%98%E9%87%8F%E8%B0%83%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">1.3.1.</span> <span class="toc-text">1. 通过类型变量调用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B-2"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">示例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%87%BA"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">输出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E7%82%B9"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">特点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%80%9A%E8%BF%87%E6%8E%A5%E5%8F%A3%E7%B1%BB%E5%9E%8B%E5%8F%98%E9%87%8F%E8%B0%83%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">1.3.2.</span> <span class="toc-text">2. 通过接口类型变量调用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B-3"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">示例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%87%BA-2"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">输出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E7%82%B9-2"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">特点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%B1%BB%E5%9E%8B%E6%96%AD%E8%A8%80%EF%BC%88Type-Assertion%EF%BC%89"><span class="toc-number">1.3.3.</span> <span class="toc-text">3. 类型断言（Type Assertion）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B-4"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">示例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%87%BA-3"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">输出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E7%82%B9-3"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">特点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-3"><span class="toc-number">1.3.4.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Channel"><span class="toc-number">1.4.</span> <span class="toc-text">Channel</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E4%BA%8E-Go-%E7%9A%84-chan%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%AE%83%E6%98%AF%E7%A9%BA%E7%9A%84%EF%BC%8C%E8%AF%BB%E5%8F%96%E6%93%8D%E4%BD%9C%E6%98%AF%E5%90%A6%E4%BC%9A%E4%B8%80%E7%9B%B4%E9%98%BB%E5%A1%9E%EF%BC%9F"><span class="toc-number">1.4.1.</span> <span class="toc-text">对于 Go 的 chan，如果它是空的，读取操作是否会一直阻塞？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#net-rpc"><span class="toc-number">1.5.</span> <span class="toc-text">net.rpc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.6.</span> <span class="toc-text">序列化和反序列化</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/29/CS-Development-%E5%90%8C%E6%AD%A5vs%E5%BC%82%E6%AD%A5/" title="同步 vs 异步：核心区别、适用场景与实现技术">同步 vs 异步：核心区别、适用场景与实现技术</a><time datetime="2025-04-29T13:35:00.000Z" title="Created 2025-04-29 21:35:00">2025-04-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/29/CS-PL-JS-asynchronous-programming/" title="Javascript: Asynchronous Programming">Javascript: Asynchronous Programming</a><time datetime="2025-04-28T17:38:00.000Z" title="Created 2025-04-29 01:38:00">2025-04-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/27/CS-Development-%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91/" title="业务逻辑 (Buisness Logic)">业务逻辑 (Buisness Logic)</a><time datetime="2025-04-27T06:50:00.000Z" title="Created 2025-04-27 14:50:00">2025-04-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/26/CS-OS-%E9%9D%A2%E8%AF%95/" title="OS: 面试">OS: 面试</a><time datetime="2025-04-26T04:51:00.000Z" title="Created 2025-04-26 12:51:00">2025-04-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/26/CS-Graphics-texture/" title="Graphics: Texture">Graphics: Texture</a><time datetime="2025-04-26T03:39:00.000Z" title="Created 2025-04-26 11:39:00">2025-04-26</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2025 By <a class="footer-bar-link" href="/" title="Exisfar" target="_blank">Exisfar</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">Articles</div><div class="length-num">82</div></a><a href="/tags/" title="tag"><div class="headline">Tags</div><div class="length-num">52</div></a><a href="/categories/" title="category"><div class="headline">Categories</div><div class="length-num">26</div></a></div><span class="sidebar-menu-item-title">Function</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="Display Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>Display Mode</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://exisfar.github.io/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/nightfall.png&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" href="https://exisfar.github.io/" title="GitHub"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/nightfall.png&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="GitHub"/><span class="back-menu-item-text">GitHub</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友链</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Algorithm/" style="font-size: 0.88rem;">Algorithm<sup>3</sup></a><a href="/tags/CS/" style="font-size: 0.88rem;">CS<sup>1</sup></a><a href="/tags/CUDA/" style="font-size: 0.88rem;">CUDA<sup>1</sup></a><a href="/tags/Compiler/" style="font-size: 0.88rem;">Compiler<sup>2</sup></a><a href="/tags/Database/" style="font-size: 0.88rem;">Database<sup>1</sup></a><a href="/tags/Development/" style="font-size: 0.88rem;">Development<sup>5</sup></a><a href="/tags/Dynamic-Programming/" style="font-size: 0.88rem;">Dynamic Programming<sup>1</sup></a><a href="/tags/English/" style="font-size: 0.88rem;">English<sup>1</sup></a><a href="/tags/Graphics/" style="font-size: 0.88rem;">Graphics<sup>2</sup></a><a href="/tags/HPC/" style="font-size: 0.88rem;">HPC<sup>1</sup></a><a href="/tags/Lexical-Analysis/" style="font-size: 0.88rem;">Lexical Analysis<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>2</sup></a><a href="/tags/ML/" style="font-size: 0.88rem;">ML<sup>2</sup></a><a href="/tags/Math/" style="font-size: 0.88rem;">Math<sup>3</sup></a><a href="/tags/Network/" style="font-size: 0.88rem;">Network<sup>1</sup></a><a href="/tags/OS/" style="font-size: 0.88rem;">OS<sup>3</sup></a><a href="/tags/OpenGL/" style="font-size: 0.88rem;">OpenGL<sup>1</sup></a><a href="/tags/Progarmming-Model/" style="font-size: 0.88rem;">Progarmming Model<sup>1</sup></a><a href="/tags/Recursion/" style="font-size: 0.88rem;">Recursion<sup>1</sup></a><a href="/tags/Texture/" style="font-size: 0.88rem;">Texture<sup>1</sup></a><a href="/tags/gcc/" style="font-size: 0.88rem;">gcc<sup>1</sup></a><a href="/tags/normalization/" style="font-size: 0.88rem;">normalization<sup>1</sup></a><a href="/tags/regularization/" style="font-size: 0.88rem;">regularization<sup>1</sup></a><a href="/tags/%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91/" style="font-size: 0.88rem;">业务逻辑<sup>1</sup></a><a href="/tags/%E4%B9%90%E7%90%86/" style="font-size: 0.88rem;">乐理<sup>1</sup></a><a href="/tags/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/" style="font-size: 0.88rem;">体系结构<sup>1</sup></a><a href="/tags/%E5%81%A5%E8%BA%AB/" style="font-size: 0.88rem;">健身<sup>1</sup></a><a href="/tags/%E5%8A%A0%E5%AF%86/" style="font-size: 0.88rem;">加密<sup>7</sup></a><a href="/tags/%E5%90%8C%E6%AD%A5/" style="font-size: 0.88rem;">同步<sup>1</sup></a><a href="/tags/%E5%9B%BE%E8%A1%A8/" style="font-size: 0.88rem;">图表<sup>1</sup></a><a href="/tags/%E5%BC%82%E6%AD%A5/" style="font-size: 0.88rem;">异步<sup>2</sup></a><a href="/tags/%E5%BE%AE%E5%88%86/" style="font-size: 0.88rem;">微分<sup>1</sup></a><a href="/tags/%E6%8A%80%E6%9C%AF%E6%A0%88/" style="font-size: 0.88rem;">技术栈<sup>1</sup></a><a href="/tags/%E6%8A%BD%E8%B1%A1%E8%83%BD%E5%8A%9B/" style="font-size: 0.88rem;">抽象能力<sup>1</sup></a><a href="/tags/%E7%94%9F%E6%B4%BB/" style="font-size: 0.88rem;">生活<sup>3</sup></a><a href="/tags/%E8%A1%A3%E7%89%A9%E5%88%86%E7%B1%BB/" style="font-size: 0.88rem;">衣物分类<sup>1</sup></a><a href="/tags/%E8%A1%A8%E8%BE%BE/" style="font-size: 0.88rem;">表达<sup>1</sup></a><a href="/tags/%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE/" style="font-size: 0.88rem;">逻辑表达<sup>1</sup></a><a href="/tags/%E9%9F%B3%E4%B9%90/" style="font-size: 0.88rem;">音乐<sup>1</sup></a><a href="/tags/%E9%A1%B9%E7%9B%AE%E7%BB%84%E7%BB%87/" style="font-size: 0.88rem;">项目组织<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="9433227449" server="tencent" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/9433227449&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Exisfar 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.cbd.int/mermaid@10.2.4/dist/mermaid.min.js').then(runMermaid)
  }

  anzhiyu.addGlobalFn('themeChange', runMermaid, 'mermaid')

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(()=>{
  const getGiscusTheme = theme => {
    return theme === 'dark' ? 'dark' : 'light'
  }

  const loadGiscus = () => {
    const config = Object.assign({
      src: 'https://giscus.app/client.js',
      'data-repo': 'Exisfar/Exisfar.github.io',
      'data-repo-id': 'R_kgDOOPtzpw',
      'data-category-id': 'DIC_kwDOOPtzp84CpOlz',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true
    },{"data-lang":"zh-CN","data-mapping":"pathname","data-category":"Announcements","data-input-position":"bottom"})

    const ele = document.createElement('script')
    for (let key in config) {
      ele.setAttribute(key, config[key])
    }
    document.getElementById('giscus-wrap').appendChild(ele)
  }

  const changeGiscusTheme = theme => {
    const sendMessage = message => {
      const iframe = document.querySelector('iframe.giscus-frame')
      if (!iframe) return
      iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app')
    }

    sendMessage({
      setConfig: {
        theme: getGiscusTheme(theme)
      }
    });
  }

  anzhiyu.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if ('Giscus' === 'Giscus' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>